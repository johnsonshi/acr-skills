# ACR Vulnerability Scanning - Feature Overview

## Executive Summary

Azure Container Registry (ACR) provides multiple vulnerability scanning capabilities to detect and remediate security issues in container images. The primary integration is with Microsoft Defender for Cloud, while ACR also offers a native Continuous Patching feature for automated OS-level vulnerability remediation and supports third-party scanning solutions.

## Core Scanning Capabilities

### 1. Microsoft Defender for Cloud Integration

Microsoft Defender for Cloud provides vulnerability scanning for container images stored in ACR. Key features include:

- **Automatic Scanning**: Images are scanned when pushed to a registry, imported into a registry, or pulled within the last 30 days
- **Vulnerability Detection**: Identifies known vulnerabilities (CVEs) in container image layers
- **Remediation Recommendations**: Provides actionable recommendations in the Microsoft Defender for Cloud dashboard
- **Re-scanning**: Automatically rescans images after recommended remediation steps are taken

**Source**: `/Users/johnsonshi/repos/acr-skills/submodules/azure-management-docs/articles/container-registry/scan-images-defender.md`

### 2. Continuous Patching (Native ACR Feature)

ACR's Continuous Patching feature automates vulnerability detection and remediation:

- **Scanning Engine**: Uses [Trivy](https://trivy.dev/) for vulnerability detection
- **Patching Engine**: Uses [Copa](https://project-copacetic.github.io/copacetic/website/) for applying security fixes
- **Automated Remediation**: Automatically patches OS-level vulnerabilities without requiring source code or build pipeline access
- **Scheduling**: Supports customizable patching schedules (1-30 days)

**Source**: `/Users/johnsonshi/repos/acr-skills/submodules/azure-management-docs/articles/container-registry/key-concept-continuous-patching.md`

### 3. Image Quarantine Pattern (Preview)

ACR supports a quarantine pattern to ensure only scanned images are accessible:

- Images pushed to quarantine-enabled registries are automatically quarantined
- Only users with `AcrQuarantineReader` role can pull quarantined images
- Vulnerability scanners can approve or reject images based on scan results
- Once approved, images become available to standard users

**Source**: `/Users/johnsonshi/repos/acr-skills/submodules/acr/docs/preview/quarantine/readme.md`

### 4. Third-Party Scanner Support

ACR is compatible with various third-party vulnerability scanning solutions:

- **Aqua Security**: Mentioned in FAQ as supported scanning solution
- **Other Azure Marketplace Solutions**: Integration with various marketplace scanning tools

**Source**: `/Users/johnsonshi/repos/acr-skills/submodules/azure-management-docs/articles/container-registry/container-registry-faq.yml` (lines 30-32)

## Vulnerability Categories

### OS-Level Vulnerabilities (Patchable via Continuous Patching)

- System packages managed by OS package managers (apt, yum)
- Security patches for underlying operating system components
- Base image vulnerabilities

### Application-Level Vulnerabilities (Require Rebuild)

- Programming language dependencies (Go, Python, NodeJS packages)
- Application framework vulnerabilities
- Custom code vulnerabilities

## Integration Points

| Integration | Purpose | Authentication |
|-------------|---------|----------------|
| Microsoft Defender for Cloud | Vulnerability scanning and recommendations | Trusted service (no additional config) |
| ACR Continuous Patching | Automated OS vulnerability remediation | ACR Tasks |
| Third-party scanners | Custom vulnerability scanning workflows | Service principal or token-based |
| Quarantine webhooks | Notification of newly pushed images for scanning | Webhook subscription |

## SKU Requirements

| Feature | Basic | Standard | Premium |
|---------|-------|----------|---------|
| Microsoft Defender scanning | Yes | Yes | Yes |
| Continuous Patching | Yes* | Yes* | Yes* |
| Image Quarantine | Yes | Yes | Yes |

*Requires ACR Tasks, which is not available in the free tier

## Key Benefits

1. **Proactive Security**: Detect vulnerabilities before deployment
2. **Automated Remediation**: Continuous Patching removes manual patching overhead
3. **Compliance**: Maintain security hygiene for regulatory requirements
4. **Speed**: Address vulnerabilities without waiting for upstream image updates
5. **Integrated Workflow**: Scanning integrates with existing CI/CD pipelines

## References

- Microsoft Defender for Cloud integration: `/Users/johnsonshi/repos/acr-skills/submodules/azure-management-docs/articles/container-registry/scan-images-defender.md`
- Continuous Patching concepts: `/Users/johnsonshi/repos/acr-skills/submodules/azure-management-docs/articles/container-registry/key-concept-continuous-patching.md`
- Continuous Patching setup: `/Users/johnsonshi/repos/acr-skills/submodules/azure-management-docs/articles/container-registry/how-to-continuous-patching.md`
- Quarantine pattern: `/Users/johnsonshi/repos/acr-skills/submodules/acr/docs/preview/quarantine/readme.md`
- ACR GitHub preview docs: `/Users/johnsonshi/repos/acr-skills/submodules/acr/docs/preview/continuous-patching/README.md`
